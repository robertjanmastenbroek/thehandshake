#!/bin/bash
#
# One-command test-fix-deploy
# Usage: ./test-fix-deploy
#

cd "$(dirname "$0")"

echo "ðŸ¤– TheHandshake Auto Test-Fix-Deploy"
echo

# Check if gh CLI is installed
if ! command -v gh &> /dev/null; then
    echo "âŒ GitHub CLI not installed"
    echo "Install with: brew install gh"
    exit 1
fi

# Check if authenticated
if ! gh auth status &> /dev/null; then
    echo "âš ï¸  Authenticating with GitHub..."
    gh auth login
fi

# Check Python dependencies
if ! python3 -c "import anthropic" 2>/dev/null; then
    echo "ðŸ“¦ Installing Python dependencies..."
    pip3 install anthropic --break-system-packages
fi

# Run the auto-fix loop
echo "ðŸš€ Starting auto-fix loop..."
echo
python3 scripts/auto_fix.py
